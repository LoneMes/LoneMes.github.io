import{r as A,A as ue,_ as V,c as he,g as ye,j as _,a as me,u as ge,t as H,L as ve,B as xe,m as oe}from"./index-84ce29cc.js";import{u as we,F as U,I as Q,C as be}from"./useMount-6193566c.js";var je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"};const Se=je;var le=function(w,p){return A.createElement(ue,V(V({},w),{},{ref:p,icon:Se}))};le.displayName="KeyOutlined";const Oe=A.forwardRef(le);var _e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"};const Ce=_e;var ce=function(w,p){return A.createElement(ue,V(V({},w),{},{ref:p,icon:Ce}))};ce.displayName="UserOutlined";const Pe=A.forwardRef(ce);var Z={},Me={get exports(){return Z},set exports(v){Z=v}},W={},ke={get exports(){return W},set exports(v){W=v}},g={};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var X,se;function Ee(){if(se)return X;se=1;var v=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable;function C(f){if(f==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(f)}function S(){try{if(!Object.assign)return!1;var f=new String("abc");if(f[5]="de",Object.getOwnPropertyNames(f)[0]==="5")return!1;for(var a={},u=0;u<10;u++)a["_"+String.fromCharCode(u)]=u;var i=Object.getOwnPropertyNames(a).map(function(m){return a[m]});if(i.join("")!=="0123456789")return!1;var y={};return"abcdefghijklmnopqrst".split("").forEach(function(m){y[m]=m}),Object.keys(Object.assign({},y)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return X=S()?Object.assign:function(f,a){for(var u,i=C(f),y,m=1;m<arguments.length;m++){u=Object(arguments[m]);for(var d in u)w.call(u,d)&&(i[d]=u[d]);if(v){y=v(u);for(var j=0;j<y.length;j++)p.call(u,y[j])&&(i[y[j]]=u[y[j]])}}return i},X}/** @license React v16.14.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ie;function Re(){if(ie)return g;ie=1;var v=Ee(),w=typeof Symbol=="function"&&Symbol.for,p=w?Symbol.for("react.element"):60103,C=w?Symbol.for("react.portal"):60106,S=w?Symbol.for("react.fragment"):60107,f=w?Symbol.for("react.strict_mode"):60108,a=w?Symbol.for("react.profiler"):60114,u=w?Symbol.for("react.provider"):60109,i=w?Symbol.for("react.context"):60110,y=w?Symbol.for("react.forward_ref"):60112,m=w?Symbol.for("react.suspense"):60113,d=w?Symbol.for("react.memo"):60115,j=w?Symbol.for("react.lazy"):60116,l=typeof Symbol=="function"&&Symbol.iterator;function n(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,c=1;c<arguments.length;c++)t+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},o={};function s(e,t,c){this.props=e,this.context=t,this.refs=o,this.updater=c||r}s.prototype.isReactComponent={},s.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error(n(85));this.updater.enqueueSetState(this,e,t,"setState")},s.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function b(){}b.prototype=s.prototype;function M(e,t,c){this.props=e,this.context=t,this.refs=o,this.updater=c||r}var E=M.prototype=new b;E.constructor=M,v(E,s.prototype),E.isPureReactComponent=!0;var z={current:null},R=Object.prototype.hasOwnProperty,L={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,c){var x,h={},P=null,N=null;if(t!=null)for(x in t.ref!==void 0&&(N=t.ref),t.key!==void 0&&(P=""+t.key),t)R.call(t,x)&&!L.hasOwnProperty(x)&&(h[x]=t[x]);var O=arguments.length-2;if(O===1)h.children=c;else if(1<O){for(var I=Array(O),T=0;T<O;T++)I[T]=arguments[T+2];h.children=I}if(e&&e.defaultProps)for(x in O=e.defaultProps,O)h[x]===void 0&&(h[x]=O[x]);return{$$typeof:p,type:e,key:P,ref:N,props:h,_owner:z.current}}function q(e,t){return{$$typeof:p,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $(e){return typeof e=="object"&&e!==null&&e.$$typeof===p}function D(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,function(c){return t[c]})}var ee=/\/+/g,F=[];function te(e,t,c,x){if(F.length){var h=F.pop();return h.result=e,h.keyPrefix=t,h.func=c,h.context=x,h.count=0,h}return{result:e,keyPrefix:t,func:c,context:x,count:0}}function re(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>F.length&&F.push(e)}function K(e,t,c,x){var h=typeof e;(h==="undefined"||h==="boolean")&&(e=null);var P=!1;if(e===null)P=!0;else switch(h){case"string":case"number":P=!0;break;case"object":switch(e.$$typeof){case p:case C:P=!0}}if(P)return c(x,e,t===""?"."+J(e,0):t),1;if(P=0,t=t===""?".":t+":",Array.isArray(e))for(var N=0;N<e.length;N++){h=e[N];var O=t+J(h,N);P+=K(h,O,c,x)}else if(e===null||typeof e!="object"?O=null:(O=l&&e[l]||e["@@iterator"],O=typeof O=="function"?O:null),typeof O=="function")for(e=O.call(e),N=0;!(h=e.next()).done;)h=h.value,O=t+J(h,N++),P+=K(h,O,c,x);else if(h==="object")throw c=""+e,Error(n(31,c==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":c,""));return P}function G(e,t,c){return e==null?0:K(e,"",t,c)}function J(e,t){return typeof e=="object"&&e!==null&&e.key!=null?D(e.key):t.toString(36)}function fe(e,t){e.func.call(e.context,t,e.count++)}function pe(e,t,c){var x=e.result,h=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?Y(e,x,c,function(P){return P}):e!=null&&($(e)&&(e=q(e,h+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(ee,"$&/")+"/")+c)),x.push(e))}function Y(e,t,c,x,h){var P="";c!=null&&(P=(""+c).replace(ee,"$&/")+"/"),t=te(t,P,x,h),G(e,pe,t),re(t)}var ne={current:null};function B(){var e=ne.current;if(e===null)throw Error(n(321));return e}var de={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:z,IsSomeRendererActing:{current:!1},assign:v};return g.Children={map:function(e,t,c){if(e==null)return e;var x=[];return Y(e,x,null,t,c),x},forEach:function(e,t,c){if(e==null)return e;t=te(null,null,t,c),G(e,fe,t),re(t)},count:function(e){return G(e,function(){return null},null)},toArray:function(e){var t=[];return Y(e,t,null,function(c){return c}),t},only:function(e){if(!$(e))throw Error(n(143));return e}},g.Component=s,g.Fragment=S,g.Profiler=a,g.PureComponent=M,g.StrictMode=f,g.Suspense=m,g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=de,g.cloneElement=function(e,t,c){if(e==null)throw Error(n(267,e));var x=v({},e.props),h=e.key,P=e.ref,N=e._owner;if(t!=null){if(t.ref!==void 0&&(P=t.ref,N=z.current),t.key!==void 0&&(h=""+t.key),e.type&&e.type.defaultProps)var O=e.type.defaultProps;for(I in t)R.call(t,I)&&!L.hasOwnProperty(I)&&(x[I]=t[I]===void 0&&O!==void 0?O[I]:t[I])}var I=arguments.length-2;if(I===1)x.children=c;else if(1<I){O=Array(I);for(var T=0;T<I;T++)O[T]=arguments[T+2];x.children=O}return{$$typeof:p,type:e.type,key:h,ref:P,props:x,_owner:N}},g.createContext=function(e,t){return t===void 0&&(t=null),e={$$typeof:i,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider={$$typeof:u,_context:e},e.Consumer=e},g.createElement=k,g.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},g.createRef=function(){return{current:null}},g.forwardRef=function(e){return{$$typeof:y,render:e}},g.isValidElement=$,g.lazy=function(e){return{$$typeof:j,_ctor:e,_status:-1,_result:null}},g.memo=function(e,t){return{$$typeof:d,type:e,compare:t===void 0?null:t}},g.useCallback=function(e,t){return B().useCallback(e,t)},g.useContext=function(e,t){return B().useContext(e,t)},g.useDebugValue=function(){},g.useEffect=function(e,t){return B().useEffect(e,t)},g.useImperativeHandle=function(e,t,c){return B().useImperativeHandle(e,t,c)},g.useLayoutEffect=function(e,t){return B().useLayoutEffect(e,t)},g.useMemo=function(e,t){return B().useMemo(e,t)},g.useReducer=function(e,t,c){return B().useReducer(e,t,c)},g.useRef=function(e){return B().useRef(e)},g.useState=function(e){return B().useState(e)},g.version="16.14.0",g}var ae;function $e(){return ae||(ae=1,function(v){v.exports=Re()}(ke)),W}(function(v,w){(function(p,C){v.exports=C($e())})(he,function(p){return function(C){var S={};function f(a){if(S[a])return S[a].exports;var u=S[a]={i:a,l:!1,exports:{}};return C[a].call(u.exports,u,u.exports,f),u.l=!0,u.exports}return f.m=C,f.c=S,f.d=function(a,u,i){f.o(a,u)||Object.defineProperty(a,u,{enumerable:!0,get:i})},f.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},f.t=function(a,u){if(1&u&&(a=f(a)),8&u||4&u&&typeof a=="object"&&a&&a.__esModule)return a;var i=Object.create(null);if(f.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:a}),2&u&&typeof a!="string")for(var y in a)f.d(i,y,function(m){return a[m]}.bind(null,y));return i},f.n=function(a){var u=a&&a.__esModule?function(){return a.default}:function(){return a};return f.d(u,"a",u),u},f.o=function(a,u){return Object.prototype.hasOwnProperty.call(a,u)},f.p="",f(f.s=0)}([function(C,S,f){C.exports=f(1)},function(C,S,f){var a,u=this&&this.__extends||(a=function(l,n){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])})(l,n)},function(l,n){function r(){this.constructor=l}a(l,n),l.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}),i=this&&this.__createBinding||(Object.create?function(l,n,r,o){o===void 0&&(o=r),Object.defineProperty(l,o,{enumerable:!0,get:function(){return n[r]}})}:function(l,n,r,o){o===void 0&&(o=r),l[o]=n[r]}),y=this&&this.__setModuleDefault||(Object.create?function(l,n){Object.defineProperty(l,"default",{enumerable:!0,value:n})}:function(l,n){l.default=n}),m=this&&this.__importStar||function(l){if(l&&l.__esModule)return l;var n={};if(l!=null)for(var r in l)r!=="default"&&Object.prototype.hasOwnProperty.call(l,r)&&i(n,l,r);return y(n,l),n};Object.defineProperty(S,"__esModule",{value:!0});var d=m(f(2));f(3).polyfill();var j=function(l){function n(r){var o,s=l.call(this,r)||this;return s.state={id:s.props.id||Date.now()+"_"+Math.random().toFixed(4),width:s.props.width||150,height:s.props.height||40,len:s.props.length||4,style:(o={position:"relative",backgroundColor:"#fff",overflow:"hidden",width:s.props.width?s.props.width+"px":"150px",height:s.props.height?s.props.height+"px":"40px",cursor:"pointer",verticalAlign:"middle",userSelect:"none"},s.props.style?Object.assign({},o,s.props.style):o),options:function(){var b={codes:["a","b","c","d","e","f","g","h","i","j","k","l","m","o","p","q","r","s","t","x","u","v","y","z","w","n","0","1","2","3","4","5","6","7","8","9"],fontSizeMin:22,fontSizeMax:26,colors:["#117cb3","#f47b06","#202890","#db1821","#b812c2"],fonts:["Times New Roman","Georgia","Serif","sans-serif","arial","tahoma","Hiragino Sans GB"],lines:8,lineColors:["#7999e1","#383838","#ec856d","#008888"],lineHeightMin:1,lineHeightMax:2,lineWidthMin:40,lineWidthMax:100};return s.props.options?Object.assign({},b,s.props.options):b}()},s}return u(n,l),n.prototype.componentDidMount=function(){this.onDraw(this.props.value)},n.prototype.componentDidUpdate=function(r){this.props.value!==r.value&&this.onDraw(this.props.value),this.props.width===r.width&&this.props.height===r.height&&this.props.style===r.style||this.setState({width:this.props.width||150,height:this.props.height||40,style:Object.assign({},this.state.style,{width:this.props.width?this.props.width+"px":"150px",height:this.props.height?this.props.height+"px":"40px"})})},n.prototype.onClick=function(){this.props.value||this.onDraw(this.props.value),this.props.onClick&&this.props.onClick()},n.prototype.codeCss=function(r,o,s){var b="rotate("+this.randint(-15,15,!0)+"deg) translateY("+this.randint(-55,-45,!0)+"%)";return["font-size:"+this.randint(this.state.options.fontSizeMin,this.state.options.fontSizeMax)+"px","color:"+this.state.options.colors[this.randint(0,this.state.options.colors.length-1)],"position: absolute","left:"+Math.max(Math.min(this.randint(r*o,r*o+r/2,!0),s),r/4)+"px","top:50%","transform:"+b+";-o-transform:"+b+";-ms-transform:"+b+";-moz-transform:"+b+";-webkit-transform:"+b,"font-family:"+this.state.options.fonts[this.randint(0,this.state.options.fonts.length-1)],"font-weight:bold","z-index:2"].join(";")},n.prototype.lineCss=function(){var r="rotate("+this.randint(-30,30)+"deg)";return["position: absolute","opacity:"+this.randint(3,8)/10,"width:"+this.randint(this.state.options.lineWidthMin,this.state.options.lineWidthMax)+"px","height:"+this.randint(this.state.options.lineHeightMin,this.state.options.lineHeightMax)+"px","background:"+this.state.options.lineColors[this.randint(0,this.state.options.lineColors.length-1)],"left:"+this.randint(-this.state.options.lineWidthMin/2,this.state.width)+"px","top:"+this.randint(0,this.state.height)+"px","transform:"+r+";-o-transform:"+r+";-ms-transform:"+r+";-moz-transform:"+r+";-webkit-transform:"+r].join(";")},n.prototype.onDraw=function(r){var o="",s=document.getElementById(this.state.id),b=/^http[s]*:\/\/|\.jpg$|\.png$|\.jpeg$|\.gif$|\.bmp$|\.webp$|^data:image/.test(r||"");if(s&&(s.innerHTML=""),b)return(k=document.createElement("img")).style.cssText=["display: block","max-width:100%","max-height:100%"].join(";"),k.src=r,s&&s.appendChild(k),this.props.onChange&&this.props.onChange(null),null;for(var M=r?r.length:this.state.len,E=this.state.width/M,z=this.state.width-E/4,R=0;R<M;R++){(k=document.createElement("span")).style.cssText=this.codeCss(E,R,z);var L=r?r[R]:this.state.options.codes[Math.round(Math.random()*(this.state.options.codes.length-1))];k.innerHTML=String(L),o=""+o+L,s&&s.appendChild(k)}for(R=0;R<this.state.options.lines;R++){var k;(k=document.createElement("div")).style.cssText=this.lineCss(),s&&s.appendChild(k)}return this.props.onChange&&this.props.onChange(o),o},n.prototype.randint=function(r,o,s){var b=o-r+1,M=Math.random()*b+r;return s?M:Math.floor(M)},n.prototype.render=function(){var r=this;return d.createElement("div",{id:this.state.id,style:this.state.style,className:this.props.className,onClick:function(){return r.onClick()}})},n}(d.PureComponent);S.default=j},function(C,S){C.exports=p},function(C,S,f){function a(u,i){if(u==null)throw new TypeError("Cannot convert first argument to object");for(var y=Object(u),m=1;m<arguments.length;m++){var d=arguments[m];if(d!=null)for(var j=Object.keys(Object(d)),l=0,n=j.length;l<n;l++){var r=j[l],o=Object.getOwnPropertyDescriptor(d,r);o!==void 0&&o.enumerable&&(y[r]=d[r])}}return y}C.exports={assign:a,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:a})}}}])})})(Me);const Ie=ye(Z);function Ae(v){const w=A.useRef(null),p=A.useRef({ctx:null,dots:[],width:0,height:0}),C=A.useRef(null);we(()=>(w.current&&(p.current.ctx=w.current.getContext("2d"),p.current&&p.current.ctx&&(p.current.ctx.strokeStyle="rgba(255,255,255,1)",p.current.width=w.current.clientWidth,p.current.height=w.current.clientHeight,w.current.width=p.current.width,w.current.height=p.current.height,f(v.row,v.col,p.current.width,p.current.height),u())),()=>{C.current&&window.cancelAnimationFrame(C.current)}));const S=(i,y)=>Math.random()*(y-i)+i,f=(i,y,m,d)=>{const j=d/(i-2),l=m/(y-2);for(let n=0;n<i;n++)for(let r=0;r<y;r++){const o={x:r*l-l/2,y:n*j-j/2,sx:S(-j/2,j/2),sy:S(-l/2,l/2),dx:!!Math.round(S(0,1)),dy:!!Math.round(S(0,1)),color:S(20,70),dcolor:!!Math.round(S(0,1))};p.current.dots.push(o)}},a=A.useCallback((i,y,m,d,j,l)=>{d.fillRect(0,0,j,l);for(let n=0;n<y;n++)for(let r=0;r<m-1;r++){const o=n*m+r,s=o+1,b=o+m,M=o-m+1;if(n<=y-2){d.beginPath(),d.moveTo(i[o].x+i[o].sx,i[o].y+i[o].sy),d.lineTo(i[s].x+i[s].sx,i[s].y+i[s].sy),d.lineTo(i[b].x+i[b].sx,i[b].y+i[b].sy),d.closePath();const E=Math.round((i[o].color+i[s].color+i[b].color)/3);d.fillStyle=`rgb(6,${Math.round(E/1.3)},${E})`,d.fill()}if(n>0){d.beginPath(),d.moveTo(i[o].x+i[o].sx,i[o].y+i[o].sy),d.lineTo(i[s].x+i[s].sx,i[s].y+i[s].sy),d.lineTo(i[M].x+i[M].sx,i[M].y+i[M].sy),d.closePath();const E=Math.round((i[o].color+i[s].color+i[M].color)/3);d.fillStyle=`rgb(6, ${Math.round(E/1.3)},${E})`,d.fill()}}},[]),u=()=>{const i=v.row,y=v.col,m=p.current.width,d=p.current.height,j=d/(i-2),l=m/(y-2);p.current.dots.forEach(function(n){n.dx?n.sx<l/3?n.sx+=.1:n.dx=!n.dx:n.sx>-(l/3)?n.sx-=.1:n.dx=!n.dx,n.dy?n.sy<j/3?n.sy+=.1:n.dy=!n.dy:n.sy>-(j/3)?n.sy-=.1:n.dy=!n.dy,n.dcolor?n.color<80?n.color+=.4:n.dcolor=!n.dcolor:n.color>20?n.color-=.4:n.dcolor=!n.dcolor}),a(p.current.dots,i,y,p.current.ctx,m,d),C.current=requestAnimationFrame(u)};return _.jsx("div",{className:"canvas-back",children:_.jsx("canvas",{ref:w})})}function Be(){const v=me(),w=ge(),[p]=U.useForm(),[C,S]=A.useState(!1),[f,a]=A.useState(!1),[u,i]=A.useState("00000"),[y,m]=A.useState(!1);A.useEffect(()=>{var o,s;const r=localStorage.getItem("userLoginInfo");if(r){const b=JSON.parse(r);a(!0),p.setFieldsValue({username:b.username,password:H.uncompile(b.password)})}r?(s=document.getElementById("vcode"))==null||s.focus():(o=document.getElementById("username"))==null||o.focus(),m(!0)},[p]);const d=A.useCallback(async(r,o)=>{let s=null,b=[],M=[],E=[];const z=await v.app.onLogin({username:r,password:o});if(!z||z.status!==200||!z.data)return z;s=z.data;const R=await v.sys.getRoleById({id:s.roles});if(!R||R.status!==200)return R;b=R.data.filter($=>$.conditions===1);const L=b.reduce(($,D)=>[...$,...D.menuAndPowers],[]),k=await v.sys.getMenusById({id:Array.from(new Set(L.map($=>$.menuId)))});if(!k||k.status!==200)return k;M=k.data.filter($=>$.conditions===1);const q=await v.sys.getPowerById({id:Array.from(new Set(L.reduce(($,D)=>[...$,...D.powers],[])))});return!q||q.status!==200?q:(E=q.data.filter($=>$.conditions===1),{status:200,data:{userBasicInfo:s,roles:b,menus:M,powers:E}})},[v.sys,v.app]),j=async()=>{try{const r=await p.validateFields();S(!0);const o=await d(r.username,r.password);o&&o.status===200?(oe.success("登录成功"),f?localStorage.setItem("userLoginInfo",JSON.stringify({username:r.username,password:H.compile(r.password)})):localStorage.removeItem("userLoginInfo"),sessionStorage.setItem("userinfo",H.compile(JSON.stringify(o.data))),await v.app.setUserInfo(o.data),w("/")):(oe.error((o==null?void 0:o.message)??"登录失败"),S(!1))}catch{}},l=r=>{a(r.target.checked)},n=r=>{p.setFieldsValue({vcode:r}),i(r||"")};return _.jsxs("div",{className:"page-login",children:[_.jsx("div",{className:"canvasBox",children:_.jsx(Ae,{row:12,col:8})}),_.jsx("div",{className:y?"loginBox show":"loginBox",children:_.jsxs(U,{form:p,children:[_.jsxs("div",{className:"title",children:[_.jsx("img",{src:ve,alt:"logo"}),_.jsx("span",{children:"React-Admin"})]}),_.jsxs("div",{children:[_.jsx(U.Item,{name:"username",rules:[{max:12,message:"最大长度为12位字符"},{required:!0,whitespace:!0,message:"请输入用户名"}],children:_.jsx(Q,{prefix:_.jsx(Pe,{style:{fontSize:13}}),size:"large",id:"username",placeholder:"admin/user",onPressEnter:j})}),_.jsx(U.Item,{name:"password",rules:[{required:!0,message:"请输入密码"},{max:18,message:"最大长度18个字符"}],children:_.jsx(Q,{prefix:_.jsx(Oe,{style:{fontSize:13}}),size:"large",type:"password",placeholder:"123456/123456",onPressEnter:j})}),_.jsxs(U.Item,{children:[_.jsx(U.Item,{name:"vcode",noStyle:!0,rules:[()=>({validator:(r,o)=>{const s=H.trim(o);return s?s.length>4?Promise.reject("验证码为4位字符"):s.toLowerCase()!==u.toLowerCase()?Promise.reject("验证码错误"):Promise.resolve():Promise.reject("请输入验证码")}})],children:_.jsx(Q,{style:{width:"200px"},size:"large",id:"vcode",placeholder:"请输入验证码",onPressEnter:j})}),_.jsx(Ie,{height:40,width:150,onChange:n,className:"vcode",style:{color:"#f00"},options:{lines:16}})]}),_.jsxs("div",{style:{lineHeight:"40px"},children:[_.jsx(be,{className:"remember",checked:f,onChange:l,children:"记住密码"}),_.jsx(xe,{className:"submit-btn",size:"large",type:"primary",loading:C,onClick:j,children:C?"请稍后":"登录"})]})]})]})})]})}export{Be as default};
