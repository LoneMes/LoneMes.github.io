(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{641:function(t,e,n){},642:function(t,e,n){var r;window,t.exports=(r=n(0),function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=s(n(2));n(3).polyfill();var a=function(t){function e(e){var n,r=t.call(this,e)||this;return r.state={id:r.props.id||(new Date).getTime()+"_"+Math.random().toFixed(4),width:r.props.width||150,height:r.props.height||40,len:r.props.length||4,style:(n={position:"relative",backgroundColor:"#fff",overflow:"hidden",width:r.props.width?r.props.width+"px":"150px",height:r.props.height?r.props.height+"px":"40px",cursor:"pointer",verticalAlign:"middle",userSelect:"none"},r.props.style?Object.assign({},n,r.props.style):n),options:function(){var t={codes:["a","b","c","d","e","f","g","h","i","j","k","l","m","o","p","q","r","s","t","x","u","v","y","z","w","n","0","1","2","3","4","5","6","7","8","9"],fontSizeMin:22,fontSizeMax:26,colors:["#117cb3","#f47b06","#202890","#db1821","#b812c2"],fonts:["Times New Roman","Georgia","Serif","sans-serif","arial","tahoma","Hiragino Sans GB"],lines:8,lineColors:["#7999e1","#383838","#ec856d","#008888"],lineHeightMin:1,lineHeightMax:1,lineWidthMin:20,lineWidthMax:60};return r.props.options?Object.assign({},t,r.props.options):t}()},r}return o(e,t),e.prototype.componentDidMount=function(){this.onDraw(this.props.value)},e.prototype.componentDidUpdate=function(t){this.props.value!==t.value&&this.onDraw(this.props.value),this.props.width===t.width&&this.props.height===t.height&&this.props.style===t.style||this.setState({width:this.props.width||150,height:this.props.height||40,style:Object.assign({},this.state.style,{width:this.props.width?this.props.width+"px":"150px",height:this.props.height?this.props.height+"px":"40px"})})},e.prototype.onClick=function(){this.props.value||this.onDraw(this.props.value),this.props.onClick&&this.props.onClick()},e.prototype.codeCss=function(t,e){return["font-size:"+this.randint(this.state.options.fontSizeMin,this.state.options.fontSizeMax)+"px","color:"+this.state.options.colors[this.randint(0,this.state.options.colors.length-1)],"position: absolute","left:"+this.randint(t*e,t*e+t-t/2)+"px","top:50%","transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","-o-transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","-ms-transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","-moz-transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","-webkit-transform:rotate("+this.randint(-15,15)+"deg) translateY(-50%)","font-family:"+this.state.options.fonts[this.randint(0,this.state.options.fonts.length-1)],"font-weight:bold","z-index:2"].join(";")},e.prototype.lineCss=function(){return["position: absolute","opacity:"+this.randint(3,8)/10,"width:"+this.randint(this.state.options.lineWidthMin,this.state.options.lineWidthMax)+"px","height:"+this.randint(this.state.options.lineHeightMin,this.state.options.lineHeightMax)+"px","background:"+this.state.options.lineColors[this.randint(0,this.state.options.lineColors.length-1)],"left:"+this.randint(-this.state.options.lineWidthMin/2,this.state.width)+"px","top:"+this.randint(0,this.state.height)+"px","transform:rotate("+this.randint(-30,30)+"deg)","-o-transform:rotate("+this.randint(-30,30)+"deg)","-ms-transform:rotate("+this.randint(-30,30)+"deg)","-moz-transform:rotate("+this.randint(-30,30)+"deg)","-webkit-transform:rotate("+this.randint(-30,30)+"deg)","font-family:"+this.state.options.fonts[this.randint(0,this.state.options.fonts.length-1)],"font-weight:"+this.randint(400,900)].join(";")},e.prototype.onDraw=function(t){var e="",n=document.getElementById(this.state.id),r=/^http[s]*:\/\/|\.jpg$|\.png$|\.jpeg$|\.gif$|\.bmp$|\.webp$|^data:image/.test(t||"");if(n.innerHTML="",r)return(l=document.createElement("img")).style.cssText=["display: block","max-width:100%","max-height:100%"].join(";"),l.src=t,n.appendChild(l),this.props.onChange&&this.props.onChange(null),null;for(var o=t?t.length:this.state.len,s=this.state.width/o/1.01,i=0;i<o;i++){(l=document.createElement("span")).style.cssText=this.codeCss(s,i);var a=t?t[i]:this.state.options.codes[Math.round(Math.random()*(this.state.options.codes.length-1))];l.innerHTML=String(a),e=""+e+a,n.appendChild(l)}for(i=0;i<this.state.options.lines;i++){var l;(l=document.createElement("div")).style.cssText=this.lineCss(),n.appendChild(l)}return this.props.onChange&&this.props.onChange(e),e},e.prototype.randint=function(t,e){var n=e-t+1,r=Math.random()*n+t;return Math.floor(r)},e.prototype.render=function(){var t=this;return i.createElement("div",{id:this.state.id,style:this.state.style,className:this.props.className,onClick:function(){return t.onClick()}})},e}(i.PureComponent);e.default=a},function(t,e){t.exports=r},function(t,e,n){"use strict";function r(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o)for(var s=Object.keys(Object(o)),i=0,a=s.length;i<a;i++){var l=s[i],c=Object.getOwnPropertyDescriptor(o,l);void 0!==c&&c.enumerable&&(n[l]=o[l])}}return n}t.exports={assign:r,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:r})}}}]))},643:function(t,e,n){},656:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),s=n(40),i=n(61),a=(n(641),n(642)),l=n.n(a),c=n(351),u=n.n(c),d=(n(346),n(348)),h=n.n(d),p=(n(347),n(157)),f=n.n(p),m=(n(158),n(357)),g=n.n(m),y=(n(359),n(3)),v=n.n(y),b=(n(60),{name:"user",theme:"outlined",icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]}}),w=n(7),x=function(t,e){return r.createElement(w.a,Object.assign({},t,{ref:e,icon:b}))};x.displayName="UserOutlined";var j=r.forwardRef(x),O={name:"key",theme:"outlined",icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]}},S=function(t,e){return r.createElement(w.a,Object.assign({},t,{ref:e,icon:O}))};S.displayName="KeyOutlined";var M=r.forwardRef(S),E=n(661);n(643);function C(t){var e=Object(r.useRef)(null),n=Object(r.useRef)({ctx:null,dots:[],width:0,height:0}),s=Object(r.useRef)(null);Object(E.a)((function(){return e.current&&(n.current.ctx=e.current.getContext("2d"),n.current&&n.current.ctx&&(n.current.ctx.strokeStyle="rgba(255,255,255,1)",n.current.width=e.current.clientWidth,n.current.height=e.current.clientHeight,e.current.width=n.current.width,e.current.height=n.current.height,a(t.row,t.col,n.current.width,n.current.height),c())),function(){s.current&&window.cancelAnimationFrame(s.current)}}));var i=function(t,e){return Math.random()*(e-t)+t},a=function(t,e,r,o){for(var s=o/(t-2),a=r/(e-2),l=0;l<t;l++)for(var c=0;c<e;c++){var u={x:c*a-a/2,y:l*s-s/2,sx:i(-s/2,s/2),sy:i(-a/2,a/2),dx:!!Math.round(i(0,1)),dy:!!Math.round(i(0,1)),color:i(20,70),dcolor:!!Math.round(i(0,1))};n.current.dots.push(u)}},l=Object(r.useCallback)((function(t,e,n,r,o,s){r.fillRect(0,0,o,s);for(var i=0;i<e;i++)for(var a=0;a<n-1;a++){var l=i*n+a,c=l+1,u=l+n,d=l-n+1;if(i<=e-2){r.beginPath(),r.moveTo(t[l].x+t[l].sx,t[l].y+t[l].sy),r.lineTo(t[c].x+t[c].sx,t[c].y+t[c].sy),r.lineTo(t[u].x+t[u].sx,t[u].y+t[u].sy),r.closePath();var h=Math.round((t[l].color+t[c].color+t[u].color)/3);r.fillStyle="rgb(6,"+Math.round(h/1.3)+","+h+")",r.fill()}if(i>0){r.beginPath(),r.moveTo(t[l].x+t[l].sx,t[l].y+t[l].sy),r.lineTo(t[c].x+t[c].sx,t[c].y+t[c].sy),r.lineTo(t[d].x+t[d].sx,t[d].y+t[d].sy),r.closePath();h=Math.round((t[l].color+t[c].color+t[d].color)/3);r.fillStyle="rgb(6, "+Math.round(h/1.3)+","+h+")",r.fill()}}}),[]),c=function(){var e=t.row,r=t.col,o=n.current.width,i=n.current.height,a=i/(e-2),u=o/(r-2);n.current.dots.forEach((function(t,e){t.dx?t.sx<u/3?t.sx+=.1:t.dx=!t.dx:t.sx>-u/3?t.sx-=.1:t.dx=!t.dx,t.dy?t.sy<a/3?t.sy+=.1:t.dy=!t.dy:t.sy>-a/3?t.sy-=.1:t.dy=!t.dy,t.dcolor?t.color<80?t.color+=.4:t.dcolor=!t.dcolor:t.color>20?t.color-=.4:t.dcolor=!t.dcolor})),l(n.current.dots,e,r,n.current.ctx,o,i),s.current=requestAnimationFrame(c)};return o.a.createElement("div",{className:"canvas-back"},o.a.createElement("canvas",{ref:e}))}var I=n(148),P=function(t,e,n,r){return new(n||(n=Promise))((function(o,s){function i(t){try{l(r.next(t))}catch(t){s(t)}}function a(t){try{l(r.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,a)}l((r=r.apply(t,e||[])).next())}))},k=function(t,e){var n,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=e.call(t,i)}catch(t){s=[6,t],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},_=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var s=arguments[e],i=0,a=s.length;i<a;i++,o++)r[o]=s[i];return r};e.default=Object(s.b)((function(t){return{}}),(function(t){return{onLogin:t.app.onLogin,getRoleById:t.sys.getRoleById,getMenusById:t.sys.getMenusById,getPowerById:t.sys.getPowerById,setUserInfo:t.app.setUserInfo}}))((function(t){var e=this,n=u.a.useForm()[0],s=Object(r.useState)(!1),a=s[0],c=s[1],d=Object(r.useState)(!1),p=d[0],m=d[1],y=Object(r.useState)("00000"),b=y[0],w=y[1],x=Object(r.useState)(!1),O=x[0],S=x[1];Object(r.useEffect)((function(){var t,e,r=localStorage.getItem("userLoginInfo");if(r){var o=JSON.parse(r);m(!0),n.setFieldsValue({username:o.username,password:i.a.uncompile(o.password)})}r?null===(e=document.getElementById("vcode"))||void 0===e||e.focus():null===(t=document.getElementById("username"))||void 0===t||t.focus(),S(!0)}),[n]);var E=Object(r.useCallback)((function(n,r){return P(e,void 0,void 0,(function(){var e,o,s,i,a,l,c,u,d;return k(this,(function(h){switch(h.label){case 0:return e=null,o=[],s=[],i=[],[4,t.onLogin({username:n,password:r})];case 1:return(a=h.sent())&&200===a.status&&a.data?(e=a.data,[4,t.getRoleById({id:e.roles})]):[2,a];case 2:return(l=h.sent())&&200===l.status?(o=l.data.filter((function(t){return 1===t.conditions})),c=o.reduce((function(t,e){return _(t,e.menuAndPowers)}),[]),[4,t.getMenusById({id:Array.from(new Set(c.map((function(t){return t.menuId}))))})]):[2,l];case 3:return(u=h.sent())&&200===u.status?(s=u.data.filter((function(t){return 1===t.conditions})),[4,t.getPowerById({id:Array.from(new Set(c.reduce((function(t,e){return _(t,e.powers)}),[])))})]):[2,u];case 4:return(d=h.sent())&&200===d.status?(i=d.data.filter((function(t){return 1===t.conditions})),[2,{status:200,data:{userBasicInfo:e,roles:o,menus:s,powers:i}}]):[2,d]}}))}))}),[t]),z=function(){return P(e,void 0,void 0,(function(){var e,r,o;return k(this,(function(s){switch(s.label){case 0:return s.trys.push([0,6,,7]),[4,n.validateFields()];case 1:return e=s.sent(),c(!0),[4,E(e.username,e.password)];case 2:return(r=s.sent())&&200===r.status?(v.a.success("登录成功"),p?localStorage.setItem("userLoginInfo",JSON.stringify({username:e.username,password:i.a.compile(e.password)})):localStorage.removeItem("userLoginInfo"),sessionStorage.setItem("userinfo",i.a.compile(JSON.stringify(r.data))),[4,t.setUserInfo(r.data)]):[3,4];case 3:return s.sent(),t.history.replace("/"),[3,5];case 4:v.a.error(null!==(o=null==r?void 0:r.message)&&void 0!==o?o:"登录失败"),c(!1),s.label=5;case 5:return[3,7];case 6:return s.sent(),[3,7];case 7:return[2]}}))}))};return o.a.createElement("div",{className:"page-login"},o.a.createElement("div",{className:"canvasBox"},o.a.createElement(C,{row:12,col:8})),o.a.createElement("div",{className:O?"loginBox show":"loginBox"},o.a.createElement(u.a,{form:n},o.a.createElement("div",{className:"title"},o.a.createElement("img",{src:I.a,alt:"logo"}),o.a.createElement("span",null,"React-Admin")),o.a.createElement("div",null,o.a.createElement(u.a.Item,{name:"username",rules:[{max:12,message:"最大长度为12位字符"},{required:!0,whitespace:!0,message:"请输入用户名"}]},o.a.createElement(h.a,{prefix:o.a.createElement(j,{style:{fontSize:13}}),size:"large",id:"username",placeholder:"admin/user",onPressEnter:z})),o.a.createElement(u.a.Item,{name:"password",rules:[{required:!0,message:"请输入密码"},{max:18,message:"最大长度18个字符"}]},o.a.createElement(h.a,{prefix:o.a.createElement(M,{style:{fontSize:13}}),size:"large",type:"password",placeholder:"123456/123456",onPressEnter:z})),o.a.createElement(u.a.Item,null,o.a.createElement(u.a.Item,{name:"vcode",noStyle:!0,rules:[function(){return{validator:function(t,e){var n=i.a.trim(e);return n?n.length>4?Promise.reject("验证码为4位字符"):n.toLowerCase()!==b.toLowerCase()?Promise.reject("验证码错误"):Promise.resolve():Promise.reject("请输入验证码")}}}]},o.a.createElement(h.a,{style:{width:"200px"},size:"large",id:"vcode",placeholder:"请输入验证码",onPressEnter:z})),o.a.createElement(l.a,{height:40,width:150,onChange:function(t){n.setFieldsValue({vcode:t}),w(t)},className:"vcode",style:{color:"#f00"},options:{lines:16}})),o.a.createElement("div",{style:{lineHeight:"40px"}},o.a.createElement(g.a,{className:"remember",checked:p,onChange:function(t){m(t.target.checked)}},"记住密码"),o.a.createElement(f.a,{className:"submit-btn",size:"large",type:"primary",loading:a,onClick:z},a?"请稍后":"登录"))))))}))}}]);