(function(t){function e(e){for(var n,s,r=e[0],c=e[1],u=e[2],h=0,d=[];h<r.length;h++)s=r[h],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&d.push(a[s][0]),a[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);l&&l(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),o()}function o(){for(var t,e=0;e<i.length;e++){for(var o=i[e],n=!0,r=1;r<o.length;r++){var c=o[r];0!==a[c]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=o[0]))}return t}var n={},a={app:0},i=[];function s(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=n,s.d=function(t,e,o){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(o,n,function(e){return t[e]}.bind(null,n));return o},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/work/vue-exchange-depth/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var u=0;u<r.length;u++)e(r[u]);var l=c;i.push([0,"chunk-vendors"]),o()})({0:function(t,e,o){t.exports=o("56d7")},2395:function(t,e,o){},2846:function(t,e,o){"use strict";o("8f7d")},"56d7":function(t,e,o){"use strict";o.r(e);o("b5d8"),o("450d");var n,a=o("f494"),i=o.n(a),s=(o("560b"),o("dcdc")),r=o.n(s),c=(o("e260"),o("e6cf"),o("cca6"),o("a79d"),o("2b0e")),u=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("div",{staticClass:"title"},[t._v("深度组件DEMO")]),o("div",{staticClass:"demo-box"},[o("div",{staticClass:"d1"},[o("VueExchangeDepth",{attrs:{marketInfo:t.marketNowObj,sourceData:t.sourceData,options:t.options,lastPrice:t.lastPrice,lastFormatFial:t.lastFormatFial},on:{onAccuracyChange:t.onAccuracyChange,onRowClick:t.onRowClick,choseChange:t.choseChange}})],1),o("div",{staticClass:"d2"},[o("div",{staticClass:"t"},[t._v("参数：")]),o("div",{staticClass:"form1"},[o("div",[o("el-checkbox",{model:{value:t.isFlash,callback:function(e){t.isFlash=e},expression:"isFlash"}},[t._v("是否开启闪烁（默认false）")])],1),o("div",{staticClass:"info"},[t._v(" 当某一价格(ticks)的数量(lots)有变化时，会闪烁一下 ")])]),o("div",{staticClass:"form1"},[o("div",[o("el-checkbox",{model:{value:t.isWindow,callback:function(e){t.isWindow=e},expression:"isWindow"}},[t._v("是否显示统计浮窗（默认true）")])],1),o("div",{staticClass:"info"},[t._v(" 把鼠标放在某一行上会显示一个档位/累计/均价的浮窗 ")])]),o("div",{staticClass:"form1"},[o("div",[o("el-radio",{attrs:{label:"left"},model:{value:t.hoverType,callback:function(e){t.hoverType=e},expression:"hoverType"}},[t._v("左边")]),o("el-radio",{attrs:{label:"right"},model:{value:t.hoverType,callback:function(e){t.hoverType=e},expression:"hoverType"}},[t._v("右边")])],1),o("div",{staticClass:"info"},[t._v("统计浮窗显示在左边还是右边")])]),o("div",{staticClass:"t mt"},[t._v("事件日志：")]),o("div",{staticClass:"form1 form2"},t._l(t.info,(function(e,n){return o("div",{key:n},[t._v(t._s(e))])})),0)])]),o("a",{staticClass:"link",attrs:{href:"https://github.com/javaLuo/vue-exchange-depth",target:"_blank",rel:"noflow"}},[t._v("github")])])},l=[],h=(o("b680"),o("d3b7"),o("25f0"),o("cc7d")),d=o.n(h),f=function(){n=new d.a("https://stream.binance.com:9443"),n.onopen=function(){console.log("open"),n.send("test")},n.onmessage=function(t){console.log("message",t.data),n.close()},n.onclose=function(){console.log("close")}},v=function(t){n.send(JSON.stringify(t).toString())},p={socket:n,initSocket:f,sendMsg:v},m=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:["deep-box-com","type-"+t.chose]},[o("div",{staticClass:"head"},[o("ul",{staticClass:"type-btns"},[o("li",{on:{click:function(e){return t.onChoseType("center")}}}),o("li",{on:{click:function(e){return t.onChoseType("ask")}}}),o("li",{on:{click:function(e){return t.onChoseType("bid")}}})]),o("DepthSelect",{attrs:{options:t.depthMinMax},model:{value:t.depthChoseState,callback:function(e){t.depthChoseState=e},expression:"depthChoseState"}})],1),o("ul",{staticClass:"data-box-title"},[o("li",[t._v("价格("+t._s(t.mu)+")")]),o("li",[t._v("数量("+t._s(t.zi)+")")]),o("li",[t._v("累计("+t._s(t.zi)+")")])]),o("div",{ref:"askul",class:["data-box ask",{show:t.show}],on:{mouseover:function(e){return t.askOver(e)},mouseleave:t.onLeave}},[o("ul",[t._l(t.askDataShow,(function(e,n){return o("li",{key:n,class:{h:!t.op.isHoverInfo},attrs:{"data-i":t.askDataShow.length-n},on:{click:function(o){return t.onRowClick(e,t.marketInfo)}}},[[o("span",[t._v(t._s(t._f("formatNumber")(e.ticks,t.muPoint)))]),o("span",{class:{flashUp:e.lots>t.flashData[e.ticks],flashDown:e.lots<t.flashData[e.ticks]}},[t._v(t._s(t._f("formatNumber")(e.lots,t.ziPoint)))]),o("span",[t._v(t._s(t._f("formatNumber")(e.total,t.ziPoint)))]),o("div",{staticClass:"percent show-sell-percent",style:"width:"+e.total/t.maxTotal*100+"%"})]],2)})),t.op.isHoverInfo?o("li",{class:["hover-li",{show:t.askOverShow}],style:"height:"+22*t.askOverIndex+"px"}):t._e()],2),t.op.isHoverInfo?o("div",{class:["hover-info",{right:"right"===t.op.hoverType},{show:t.askOverShow}],style:"transform:translateY(calc(50% - "+22*t.askOverIndex+"px))"},[o("div",[o("span",[t._v("档位:")]),o("span",[t._v(t._s(t.askOverIndex))])]),o("div",[o("span",[t._v("累计("+t._s(t.zi)+"):")]),o("span",[t._v(t._s(t.overAskNum[0]))])]),o("div",[o("span",[t._v("均价("+t._s(t.mu)+"):")]),o("span",[t._v("≈ "+t._s(t.overAskNum[1]))])])]):t._e()]),o("div",{staticClass:"middle-box"},[o("span",{class:[{green:t.updownData>0},{red:t.updownData<0}]},[t._v(t._s(t._f("formatNumber")(t.lastPrice,t.muPoint)))]),o("span",[t._v(t._s(t.lastFormatFial))])]),o("div",{class:["data-box bid",{show:t.show}],on:{mouseover:function(e){return t.bidOver(e)},mouseleave:t.onLeave}},[o("ul",[t._l(t.bidDataShow,(function(e,n){return o("li",{key:n,class:{h:!t.op.isHoverInfo},attrs:{"data-i":n+1},on:{click:function(o){return t.onRowClick(e,t.marketInfo,t.ziPoint,t.muPoint)}}},[o("span",[t._v(t._s(t._f("formatNumber")(e.ticks,t.muPoint)))]),o("span",{class:{flashUp:e.lots>t.flashData[e.ticks],flashDown:e.lots<t.flashData[e.ticks]}},[t._v(t._s(t._f("formatNumber")(e.lots,t.ziPoint)))]),o("span",[t._v(t._s(t._f("formatNumber")(e.total,t.ziPoint)))]),o("div",{staticClass:"percent show-buy-percent",style:"width:"+e.total/t.maxTotal*100+"%"})])})),t.op.isHoverInfo?o("li",{class:["hover-li",{show:t.bidOverShow}],style:"height:"+22*t.bidOverIndex+"px"}):t._e()],2),t.op.isHoverInfo?o("div",{class:["hover-info",{right:"right"===t.op.hoverType},{show:t.bidOverShow}],style:"transform:translateY(calc(-50% + "+22*t.bidOverIndex+"px))"},[o("div",[o("span",[t._v("档位:")]),o("span",[t._v(t._s(t.bidOverIndex))])]),o("div",[o("span",[t._v("累计("+t._s(t.zi)+"):")]),o("span",[t._v(t._s(t.overBidNum[0]))])]),o("div",[o("span",[t._v("均价("+t._s(t.mu)+"):")]),o("span",[t._v("≈ "+t._s(t.overBidNum[1]))])])]):t._e()])])},b=[],g=o("2909"),k=o("5530"),w=(o("cb29"),o("a9e3"),o("99af"),o("07ac"),o("fb6a"),o("ac1f"),o("1276"),o("466d"),o("9129"),o("a15b"),o("7db0"),o("9dcd")),D=o.n(w);D.a.RM=0;var _=function(t,e){return isNaN(t)||null===t?"--":new D.a(t).toFixed(e)},y=function(t){return isNaN(t)||null===t?"--":new D.a(t).toFixed()},O=function(t,e){return isNaN(t)||null===t?"--":D()(t).toPrecision(e)},x=function(t,e){return new D.a(t).gt(e)},C=function(t,e){return new D.a(t).lt(e)},S=function(t,e){return new D.a(t).div(e)},P=function(t,e){return new D.a(t).plus(e)},N=function(t){return new D.a(t).toString()},F={toFixedPoint:_,toFixedAuto:y,toPrecision:O,toStr:N,isGt:x,isLt:C,div:S,add:P},j=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"depth-select",on:{mouseup:function(t){t.stopPropagation()},touchend:function(t){t.stopPropagation()}}},[o("div",{staticClass:"depth-input",on:{click:t.triggerShow}},[o("div",[t._v(t._s(t.value&&t.value.label||"深度合并"))]),o("div",{class:["depth-arrow",{show:t.show}]})]),o("div",{class:["depth-select-body",{show:t.show}]},[o("div",{staticClass:"depth-tri"}),o("ul",{staticClass:"depth-options",on:{click:function(e){return t.onDepthChose(e)}}},[t._l(t.options,(function(e){return o("li",{key:e.value,class:["depth-list",{chosed:t.value.value===e.value}],attrs:{"data-label":e.label,"data-value":e.value}},[t._v(" "+t._s(e.label)+" ")])})),0===t.options.length?o("li",{staticClass:"no-depth",attrs:{"data-value":"no"}},[t._v(" 无深度 ")]):t._e()],2)])])},I=[],T={name:"depth-select",props:{options:{type:Array,default:function(){return[]}},value:Object},data:function(){return{show:!1}},model:{prop:"value",event:"change"},mounted:function(){document.addEventListener("mouseup",this.closeShow,!1),document.addEventListener("touchend",this.closeShow,!1)},beforeDestroy:function(){document.removeEventListener("mouseup",this.closeShow,!1),document.removeEventListener("touchend",this.closeShow,!1)},methods:{onDepthChose:function(t){this.closeShow(),"no"!==t.target.dataset.value&&this.$emit("change",{label:t.target.dataset.label,value:t.target.dataset.value})},triggerShow:function(){this.show=!this.show},closeShow:function(){this.show=!1}}},z=T,M=(o("2846"),o("2877")),A=Object(M["a"])(z,j,I,!1,null,"78b4c8fa",null),H=A.exports,L={name:"vue-exchange-depth",data:function(){return{muchArr:new Array(30).fill(""),show:!0,chose:"center",depthChoseState:void 0,deepHeight:0,flashData:{},bidOverShow:!1,askOverShow:!1,bidOverIndex:0,askOverIndex:0,optionsDefault:{isFlash:!1,hoverType:"right",isHoverInfo:!0,isFrontDepth:!1}}},props:{sourceData:{type:Object,default:function(){}},lastPrice:{type:[String,Number],default:0},marketInfo:{type:Object,default:function(){}},updownData:{type:Number,default:0},lastFormatFial:{type:String,default:""},options:{type:Object,default:function(){}}},components:{DepthSelect:H},filters:{formatNumber:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return F.toFixedPoint(t,e)}},computed:{op:function(){return Object(k["a"])(Object(k["a"])({},this.optionsDefault),this.options)},zi:function(){return this.marketInfo.zi||""},mu:function(){return this.marketInfo.mu||""},ziPoint:function(){return this.marketInfo.ziPoint||8},muPoint:function(){return this.marketInfo.muPoint||8},marketName:function(){return"".concat(this.marketInfo.zi,"/").concat(this.marketInfo.mu)},askData:function(){var t=this.sourceData.askData?Object(g["a"])(this.sourceData.askData):[];return t},bidData:function(){return this.sourceData.bidData?Object(g["a"])(this.sourceData.bidData):[]},sourceDataDepth:function(){var t=this.depthChoseState?this.depthChoseState.value.length-1:0,e=this.askData,o=this.bidData;if(!this.sourceData||!this.sourceData.askData)return{askData:this.askData,bidData:this.bidData};for(var n={},a={},i=0;i<e.length;i++){var s=F.toFixedPoint(e[i].ticks,this.muPoint),r=s.indexOf(".")>-1?s.length-1:s.length,c=F.toStr(F.toPrecision(s,r-t));n[c]?n[c].lots=F.toStr(F.add(n[c].lots,e[i].lots)):n[c]=Object(k["a"])(Object(k["a"])({},e[i]),{},{ticks:c})}for(var u=0;u<o.length;u++){var l=F.toFixedPoint(o[u].ticks,this.muPoint),h=l.indexOf(".")>-1?l.length-1:l.length;if(!(h<=t)){var d=F.toStr(F.toPrecision(l,h-t));a[d]?a[d].lots=F.toStr(F.add(a[d].lots,o[u].lots)):a[d]=Object(k["a"])(Object(k["a"])({},o[u]),{},{ticks:d})}}var f=Object.values(n).sort((function(t,e){return F.isGt(t.ticks,e.ticks)?-1:1})),v=Object.values(a).sort((function(t,e){return F.isGt(t.ticks,e.ticks)?-1:1}));return{askData:f,bidData:v}},askDataCom:function(){var t=this.sourceDataDepth.askData;t.reverse();for(var e=0;e<t.length;e++)t[e].total=0===e?Number(t[e].lots):t[e-1].total+Number(t[e].lots);return t.reverse(),t},bidDataCom:function(){for(var t=this.sourceDataDepth.bidData,e=0;e<t.length;e++)t[e].total=0===e?Number(t[e].lots):t[e-1].total+Number(t[e].lots);return t},askDataShow:function(){return Object(g["a"])(this.askDataCom).reverse().slice(0,this.askH).reverse()},bidDataShow:function(){return this.bidDataCom.slice(0,this.bidH)},askH:function(){switch(this.chose){case"center":return Math.ceil(this.deepHeight/22);case"ask":return 2*Math.ceil(this.deepHeight/22);default:return 0}},bidH:function(){switch(this.chose){case"center":return Math.ceil(this.deepHeight/22);case"bid":return 2*Math.ceil(this.deepHeight/22);default:return 0}},overBidNum:function(){var t=this.bidDataShow;if(!this.bidOverShow)return[0,0];for(var e=0,o=0,n=0;n<this.bidOverIndex;n++)t[n]&&(e+=Number(t[n].lots),o+=Number(t[n].ticks));return e=F.toFixedPoint(e,this.ziPoint),o=F.toFixedPoint(o/this.bidOverIndex,this.muPoint),[e,o]},overAskNum:function(){var t=this.askDataShow;if(!this.askOverShow)return[0,0];for(var e=0,o=0,n=t.length-this.askOverIndex;n<this.askDataShow.length;n++)t[n]&&(e+=Number(t[n].lots),o+=Number(t[n].ticks));return e=F.toFixedPoint(e,this.ziPoint),o=F.toFixedPoint(o/this.askOverIndex,this.muPoint),[e,o]},maxTotal:function(){var t=0,e=0;return this.bidDataCom.length&&(t=this.bidDataCom[this.bidDataCom.length-1].total),this.askDataCom.length&&(e=this.askDataCom[0].total),Math.max(t,e)},firstValue:function(){var t=this.bidData[0]?this.bidData[0].ticks:"";return t||""},depthMinMax:function(){var t,e,o=!1;if(this.firstValue){e=F.toFixedAuto(this.firstValue).split("."),o=F.isGt(e[0],1);var n=0;F.isLt(this.firstValue,1)&&(n=e[1]?-e[1].match(/[1-9]/).index:0),t=n}else t=NaN;if(Number.isNaN(t))return[];for(var a=[],i=1,s=0,r=0;r<this.muPoint;r++)i=Math.pow(10,r),s++,a.push({label:"0.".concat(new Array(this.muPoint-1-r).fill("0").join(""),"1"),value:F.toFixedAuto(i)});for(var c=o?e[0].length:0,u=0;u<c;u++)i=Math.pow(10,s+u),a.push({label:"1".concat(new Array(u).fill("0").join("")),value:F.toFixedAuto(i)});for(var l=0;l>t;l--)a.pop();return a}},watch:{marketName:function(){this.show=!1},askData:function(t){t&&t.length&&(this.show=!0)},bidData:function(t){t&&t.length&&(this.show=!0)},sourceDataDepth:function(t){var e=this;this.op.isFlash?setTimeout((function(){e.flashData=Object(k["a"])(Object(k["a"])({},t.askData.reduce((function(t,e){return t[e.ticks]=e.lots,t}),{})),t.bidData.reduce((function(t,e){return t[e.ticks]=e.lots,t}),{}))}),100):this.flashData={}},depthChoseState:function(t){t&&this.$emit("onAccuracyChange",t)},depthMinMax:function(t,e){var o=this;t&&t.length?t.length<e.length?t.find((function(t){return t.value===o.depthChoseState}))||(this.depthChoseState=t[0]):this.depthChoseState||(this.depthChoseState=t[0]):this.depthChoseState=void 0}},mounted:function(){window.addEventListener("resize",this.onResize,!1),this.onResize()},beforeDestroy:function(){window.removeEventListener("resize",this.onResize,!1)},methods:{onResize:function(){this.deepHeight=this.$refs.askul.clientHeight},onRowClick:function(t,e){this.$emit("onRowClick",t,e)},onChoseType:function(t){this.chose=t,this.$emit("choseChange",t)},askOver:function(t){var e=null;"LI"===t.target.tagName?e=t.target:"LI"===t.target.offsetParent.tagName&&(e=t.target.offsetParent);var o=e&&e.getAttribute("data-i");o?(this.askOverIndex=Number(o),this.askOverShow=!0):this.onLeave()},bidOver:function(t){var e=null;"LI"===t.target.tagName?e=t.target:"LI"===t.target.offsetParent.tagName&&(e=t.target.offsetParent);var o=e&&e.getAttribute("data-i");o?(this.bidOverIndex=Number(o),this.bidOverShow=!0):this.onLeave()},onLeave:function(){this.askOverShow=!1,this.bidOverShow=!1}}},E=L,R=(o("dc22"),Object(M["a"])(E,m,b,!1,null,null,null)),$=R.exports,J={name:"App",components:{VueExchangeDepth:$},data:function(){return{isFlash:!0,isWindow:!0,isFrontDepth:!0,hoverType:"left",marketNowObj:{zi:"BTC",mu:"USDT",ziPoint:8,muPoint:4},sourceData:{},lastPrice:0,lastFormatFial:"",info:[],deep:{value:"1"}}},mounted:function(){this.randomData(),p.initSocket()},beforeDestroy:function(){p.close()},methods:{onAccuracyChange:function(t){this.info.push("深度变化：".concat(JSON.stringify(t))),this.deep.value=t.value},onRowClick:function(t,e){this.info.push("点击了一行："),this.info.push(JSON.stringify(t)),this.info.push(JSON.stringify(e))},choseChange:function(t){this.info.push("选择了左上角按钮：".concat(JSON.stringify(t)))},random:function(t,e,o){var n=Math.random()*(e-t)+t;return o?Math.round(n):n},randomData:function(){for(var t=this,e=[],o=[],n=0;n<20;n++)e.push({ticks:50000.123456789+10*n+(this.random(1,10,!0)<8?0:this.random(10,100))+"",lots:this.random(1,10,!0)<=8?n+1.23456789+"":n+this.random(1,10)+"",count:this.random(1,50,!0)}),o.push({ticks:49900-10*n-(this.random(1,10,!0)<8?0:this.random(10,100)),lots:this.random(1,10,!0)<=8?n+1.23456789:n+this.random(1,10),count:this.random(1,50,!0)});e.reverse(),setTimeout((function(){t.sourceData={askData:e,bidData:o},t.lastPrice=100*Math.random()+49900,t.lastFormatFial=" ≈ ".concat((6.4*t.lastPrice).toFixed(2)," RMB"),t.randomData()}),200)},initSocket:function(){p.initSocket()}},computed:{options:function(){return{isFlash:this.isFlash,hoverType:this.hoverType,isHoverInfo:this.isWindow,isFrontDepth:this.isFrontDepth}}}},B=J,V=(o("7c55"),Object(M["a"])(B,u,l,!1,null,null,null)),W=V.exports,G=o("9483");Object(G["a"])("".concat("/work/vue-exchange-depth/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});o("0fae");c["a"].config.productionTip=!1,c["a"].use(r.a),c["a"].use(i.a),new c["a"]({render:function(t){return t(W)}}).$mount("#app")},"7c55":function(t,e,o){"use strict";o("2395")},"7f90":function(t,e,o){},"8f7d":function(t,e,o){},dc22:function(t,e,o){"use strict";o("7f90")}});
//# sourceMappingURL=app.2e861a92.js.map